window.addEventListener("DOMContentLoaded",()=>{const defaultConfig={size:240,backColor:"#ffffff",foreColor:"#000000",level:"Q"};let form=document.querySelector(".options-box form");function sendNotifications(options={}){let notID=`notif${(new Date).getTime()}`;chrome.notifications.create(notID,options,function(){setTimeout(()=>{chrome.notifications.clear(notID,function(wasCleared){console.log("Notification "+notID+" cleared: "+wasCleared)})},3e3)})}const setForm=data=>{form.size.value=data.size,form.backColor.value=data.backColor,form.foreColor.value=data.foreColor,form.level.value=data.level};chrome.storage.sync.get(["config"],result=>{let oldData=result.config?JSON.parse(result.config):defaultConfig;setForm(oldData)}),form.addEventListener("submit",evt=>{evt.preventDefault();const size=form.size.value,backColor=form.backColor.value,foreColor=form.foreColor.value,level=form.level.value;chrome.storage.sync.set({config:JSON.stringify({size:size,backColor:backColor,foreColor:foreColor,level:level})}),sendNotifications({type:"basic",title:"Save success！",message:"The new setting is enabled！",expandedMessage:"The new setting is enabled！",iconUrl:"./images/qrcode.png"})}),form.querySelector(".reset-btn").addEventListener("click",evt=>{evt.preventDefault(),chrome.storage.sync.set({config:JSON.stringify(defaultConfig)},()=>{setForm(defaultConfig)}),sendNotifications({type:"basic",title:"Reset the success！",message:"The default Settings have been restored",expandedMessage:"The default Settings have been restored",iconUrl:"./images/qrcode.png"})})});